#!/bin/env python3
import sys

class Mainchain:
    def __init__(self, index, sequence):
        self.index = index
        self.sequence = (sequence)
        self.column0 = ['C', 'C', 'H', 'C', 'N', 'O', 'H']
        self.column1 = [1, 4, 4, 4, 5, 5, 8]
        self.column2 = ['1.44577', '1.52290', '1.08195', '1.52324', '1.34537', '1.21961', '1.00881']
        self.column3 = [3, 1, 5, 6, 4, 8, 5]
        self.column4 = ['120.00010', '109.46670', '109.46670', '109.46670', '120.00010', '120.00010', '120.00010']
        self.column5 = [-2, -2, 1, 5, 1, 4, 9]
        self.column6 = ['-180.00000', 'M', '-120.00000', '120.00000', 'M', '180.00000', '180.00000']
    def reset(self):
        if self.sequence[self.index] == 'G':
            self.column0[3]='H'
            self.column2[3]='1.08195'
        if self.index+1 < len(self.sequence) and self.sequence[self.index+1] == 'P':
            self.column0[6]='C'
            self.column2[6]='1.345371'
        if self.index == len(self.sequence)-1:
            self.column6[6]='180.00001'
        if self.index > 0:
            self.column6[0]='180.00000'
        self.column1 = [(x+self.index*7) for x in self.column1]
        self.column3 = [(x+self.index*7) for x in self.column3]
        self.column5 = [abs(x+self.index*7) for x in self.column5]
        self.column6[1] = 'M'+str(2*self.index+1)
        self.column6[4] = 'M'+str(2*self.index+2)
        self.columns = [self.column0, self.column1, self.column2, self.column3, self.column4, self.column5, self.column6]
class Sidechain:
    def __init__(self, index, sequence):
        self.index = index
        self.sequence = (sequence)
        self.column = [[], [], [], [], [], [], []]
        if self.sequence[self.index] == 'A':
            self.column[0] = ['H', 'H', 'H']
            self.column[1] = [7, 7, 7]
            self.column[2] = [1.008823, 1.008823, 1.008823]
            self.column[3] = [4, 11, 12]
            self.column[4] = [109.4667, 109.4667, 109.4667]
            self.column[5] = [5, 4, 11]
            self.column[6] = [180.001, -120.001, 120.001]
        elif self.sequence[self.index] == 'C':
            self.column[0] = list("SHHH")
            self.column[1] = [7, 7, 7, 11]
            self.column[2] = [1.840001, 1.008823, 1.008823, 1.370001]
            self.column[3] = [4, 11, 12, 7]
            self.column[4] = [109.4667, 109.4667, 109.4667, 120.0001]
            self.column[5] = [5, 4, 11, 4]
            self.column[6] = [800.001, -120.0001, 120.0001, 800.001]
        elif self.sequence[self.index] == 'D':
            self.column[0] = list("CHHOOH")
            self.column[1] = [7, 7, 7, 11, 11, 14]
            self.column[2] = [1.521188, 1.008823, 1.008823, 1.349827, 1.218679, 1.009332]
            self.column[3] = [4, 11, 12, 7, 14, 11]
            self.column[4] = [109.4667, 109.4667, 109.4667, 114.7075, 123.2014, 115.6345]
            self.column[5] = [5, 4, 11, 4, 7, 15]
            self.column[6] = [800.0001, -120.0001, 120.0001, 800.0001, 180.0001, 800.0001]
        elif self.sequence[self.index] == 'd':
            self.column[0] = list("CHHOO")
            self.column[1] = [7, 7, 7, 11, 11]
            self.column[2] = [1.521188, 1.008823, 1.008823, 1.284253, 1.284253]
            self.column[3] = [4, 11, 12, 7, 14]
            self.column[4] = [109.4667, 109.4667, 109.4667, 120.0001, 120.0001]
            self.column[5] = [5, 4, 11, 4, 7]
            self.column[6] = [800.0001, -120.0001, 120.0001, 800.0001, 180.0001]
        elif self.sequence[self.index] == 'E':
            self.column[0] = list("CHHCHHOOH")
            self.column[1] = [7, 7, 7, 11, 11, 11, 14, 14, 17]
            self.column[2] = [1.521188, 1.008823, 1.008823, 1.521188, 1.008823, 1.008823, 1.349827, 1.218679, 1.009332]
            self.column[3] = [4, 11, 12, 7, 14, 15, 11, 17, 14]
            self.column[4] = [109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 114.7075, 123.2014, 115.6345]
            self.column[5] = [5, 4, 11, 4, 7, 14, 7, 11, 18]
            self.column[6] = [800.001, -120.0001, 120.0001, 800.001, -120.0001, 120.0001, 800.001, 180.001, 800.0001]
        elif self.sequence[self.index] == 'e':
            self.column[0] = list("CHHCHHOO")
            self.column[1] = [7, 7, 7, 11, 11, 11, 14, 14]
            self.column[2] = [1.521188, 1.008823, 1.008823, 1.521188, 1.008823, 1.008823, 1.349827, 1.218679]
            self.column[3] = [4, 11, 12, 7, 14, 15, 11, 17]
            self.column[4] = [109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 114.7075, 123.2014]
            self.column[5] = [5, 4, 11, 4, 7, 14, 7, 11]
            self.column[6] = [800.001, -120.0001, 120.0001, 800.001, -120.0001, 120.0001, 800.001, 180.001]
        elif self.sequence[self.index] == 'F':
            self.column[0] = list("CHHCHCHCHCHCH")
            self.column[1] = [7, 7, 7, 11, 14, 14, 16, 16, 18, 18, 20, 20, 22]
            self.column[2] = [1.521188, 1.008823, 1.008823, 1.521188, 1.008823, 1.521188, 1.008823, 1.521188, 1.008823, 1.521188, 1.008823, 1.521188, 1.008823]
            self.column[3] = [4, 11, 12, 7, 11, 15, 14, 17, 16, 19, 18, 21, 20]
            self.column[4] = [109.4667, 109.4667, 109.4667, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001]
            self.column[5] = [5, 4, 11, 4, 7, 11, 15, 14, 17, 16, 19, 18, 21]
            self.column[6] = [800.001, -120.0001, 120.0001, 800.001, 0.0001, 180.001, 0.00001, 180.0001, 0.0001, 180.0001, 0.0001, 180.0001, 0.00001]
        elif self.sequence[self.index] == 'H':
            self.column[0] = list("CHHNCHNHCH")
            self.column[1] = [7, 7, 7, 11, 14, 15, 15, 17, 17, 19]
            self.column[2] = [1.521188, 1.008823, 1.008823, 1.380001, 1.310001, 1.008823, 1.320001, 1.008823, 1.380001, 1.008823]
            self.column[3] = [4, 11, 12, 7, 11, 14, 16, 15, 18, 17]
            self.column[4] = [109.4667, 109.4667, 109.4667, 121.4001, 105.8001, 125.9001, 122.6001, 126.5001, 126.1001, 122.5001]
            self.column[5] = [5, 4, 11, 4, 7, 11, 14, 16, 15, 18]
            self.column[6] = [800.001, -120.0001, 120.0001, 800.001, 180.0001, 180.0001, 180.0001, 0.000001, 180.0001, 0.000001]
        elif self.sequence[self.index] == '6':
            self.column[0] = list("CHHNHCHNHCH")
            self.column[1] = [7,  7,  7, 11, 14, 14, 16, 16, 18, 18, 20]
            self.column[2] = [1.521188, 1.008823, 1.008823, 1.380001, 1.008823, 1.320001, 1.008823, 1.310001, 1.008823, 1.380001, 1.008823]
            self.column[3] = [4, 11, 12,  7, 11, 11, 14, 17, 16, 16, 18]
            self.column[4] = [109.4667, 109.4667, 109.4667, 121.4001, 127.1001, 105.8001, 125.9001, 122.6001, 126.5001, 107.4001, 122.5001]
            self.column[5] = [5,  4, 11,  4,  7,  7, 11, 14, 14, 14, 16]
            self.column[6] = [800.001, -120.0001, 120.0001, 800.001, 0.000001, 180.0001, 180.0001, 180.0001, 180.0001, 0.000001, 180.0001]
        elif self.sequence[self.index] == 'h':
            self.column[0] = list("CHHNHCHNCH")
            self.column[1] = [7,  7,  7, 11, 14, 14, 16, 16, 18, 19]
            self.column[2] = [1.521188, 1.008823, 1.008823, 1.380001, 1.008823, 1.320001, 1.008823, 1.310001, 1.380001, 1.008823]
            self.column[3] = [4, 11, 12,  7, 11, 11, 14, 17, 16, 18]
            self.column[4] = [109.4667, 109.4667, 109.4667, 121.4001, 127.1001, 105.8001, 125.9001, 122.6001, 107.4001, 122.5001]
            self.column[5] = [5,  4, 11,  4,  7,  7, 11, 14, 14, 16]
            self.column[6] = [800.001, -120.0001, 120.0001, 800.001, 0.000001, 180.0001, 180.0001, 180.0001, 0.000001, 180.0001]
        elif self.sequence[self.index] == 'I':
            self.column[0] = list("CHCCHHHHHHHH")
            self.column[1] = [7, 7, 7, 11, 11, 11, 14, 14, 14, 13, 13, 13]
            self.column[2] = [1.521188, 1.008823, 1.521188, 1.521188, 1.008823, 1.008823, 1.008823, 1.008823, 1.008823, 1.008823, 1.008823, 1.008823]
            self.column[3] = [4, 11, 12, 7, 14, 15, 11, 17, 18, 7, 20, 21]
            self.column[4] = [109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667]
            self.column[5] = [5, 4, 11, 4, 7, 14, 7, 11, 17, 12, 7, 20]
            self.column[6] = [800.001, -120.001, 120.001, 800.001, -120.001, 120.0001, 60.001, -120.001, 120.001, 180.001, -120.001, 120.001]
        elif self.sequence[self.index] == 'K':
            self.column[0] = list("CHHCHHCHHNHHHH")
            self.column[1] = [7, 7, 7, 11, 11, 11, 14, 14, 14, 17, 17, 17, 20, 20]
            self.column[2] = [1.521188, 1.008823, 1.008823, 1.521188, 1.008823, 1.008823, 1.521188, 1.008823, 1.008823, 1.400001, 1.008823, 1.008823, 1.008823, 1.008823]
            self.column[3] = [4, 11, 12, 7, 14, 15, 11, 17, 18, 14, 20, 21, 17, 23]
            self.column[4] = [109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667]
            self.column[5] = [5, 4, 11, 4, 7, 14, 7, 11, 17, 11, 14, 20, 14, 17]
            self.column[6] = [800.001, -120.0001, 120.0001, 800.001, -120.0001, 120.0001, 800.001, -120.0001, 120.0001, 800.001, -120.0001, 120.0001, 800.001, -120.00001]
        elif self.sequence[self.index] == 'k':
            self.column[0] = list("CHHCHHCHHNHHHHH")
            self.column[1] = [7, 7, 7, 11, 11, 11, 14, 14, 14, 17, 17, 17, 20, 20, 20]
            self.column[2] = [1.521188, 1.008823, 1.008823, 1.521188, 1.008823, 1.008823, 1.521188, 1.008823, 1.008823, 1.400001, 1.008823, 1.008823, 1.008823, 1.008823, 1.008823]
            self.column[3] = [4, 11, 12, 7, 14, 15, 11, 17, 18, 14, 20, 21, 17, 23, 23]
            self.column[4] = [109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667]
            self.column[5] = [5, 4, 11, 4, 7, 14, 7, 11, 17, 11, 14, 20, 14, 17, 17]
            self.column[6] = [800.001, -120.0001, 120.0001, 800.001, -120.0001, 120.0001, 800.001, -120.0001, 120.0001, 800.001, -120.0001, 120.0001, 800.001, -120.00001, 120.00001]
        elif self.sequence[self.index] == 'L':
            self.column[0] = list("CHHCHCHHHHHH")
            self.column[1] = [7, 7, 7, 11, 11, 11, 14, 14, 14, 16, 16, 16]
            self.column[2] = [1.521188, 1.008823, 1.008823, 1.521188, 1.008823, 1.521188, 1.008823, 1.008823, 1.008823, 1.008823, 1.008823, 1.008823]
            self.column[3] = [4, 11, 12, 7, 14, 15, 11, 17, 18, 11, 20, 21]
            self.column[4] = [109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667]
            self.column[5] = [5, 4, 11, 4, 7, 14, 7, 11, 17, 15, 11, 20]
            self.column[6] = [800.001, -120.001, 120.001, 800.001, -120.001, 120.001, 60.001, -120.001, 120.001, 180.001, -120.001, 120.001]
        elif self.sequence[self.index] == 'M':
            self.column[0] = list("CHHSHHCHHH")
            self.column[1] = [7, 7, 7, 11, 11, 11, 14, 17, 17, 17]
            self.column[2] = [1.521188, 1.008823, 1.008823, 1.830001, 1.008823, 1.008823, 1.830001, 1.008823, 1.008823, 1.008823]
            self.column[3] = [4, 11, 12, 7, 14, 15, 11, 14, 18, 19]
            self.column[4] = [109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667]
            self.column[5] = [5, 4, 11, 4, 7, 14, 7, 11, 14, 18]
            self.column[6] = [800.001, -120.0001, 120.0001, 800.001, -120.0001, 120.0001, 800.001, 180.0001, -120.0001, 120.0001]
        elif self.sequence[self.index] == 'N':
            self.column[0] = list("CHHNOHH")
            self.column[1] = [7, 7, 7, 11, 11, 14, 14]
            self.column[2] = [1.521188, 1.008823, 1.008823, 1.310001, 1.349827, 1.008823, 1.008823]
            self.column[3] = [4, 11, 12, 7, 14, 11, 16]
            self.column[4] = [109.4667, 109.4667, 109.4667, 120.0001, 120.0001, 120.0001, 120.0001]
            self.column[5] = [5, 4, 11, 4, 7, 15, 11]
            self.column[6] = [800.001, -120.0001, 120.0001, 800.001, 180.0001, 180.0001, 180.0001]
        elif self.sequence[self.index] == 'P':
            self.column[0] = list("CHHHHHH")
            self.column[1] = [7, 7, 7, 11, 11, 3, 3]
            self.column[2] = [1.57000, 1.00882, 1.00882, 1.00882, 1.00882, 1.00882, 1.00882]
            self.column[3] = [4, 11, 12, 3, 14, 1, 16]
            self.column[4] = [83.00000, 109.46670, 109.46670, 109.46670, 109.46670, 109.46670, 109.46670]
            self.column[5] = [5, 4, 11, 7, 3, 11, 1]
            self.column[6] = [800.001, -120.0001, 120.0001, -120.0001, 120.0001, -120.0001, 120.0001]
        elif self.sequence[self.index] == 'Q':
            self.column[0] = list("CHHCHHNOHH")
            self.column[1] = [7, 7, 7, 11, 11, 11, 14, 14, 17, 17]
            self.column[2] = [1.521188, 1.008823, 1.008823, 1.521188, 1.008823, 1.008823, 1.349827, 1.218679, 1.009332, 1.009332]
            self.column[3] = [4, 11, 12, 7, 14, 15, 11, 17, 14, 19]
            self.column[4] = [109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 114.7075, 123.2014, 115.6345, 120.0001]
            self.column[5] = [5, 4, 11, 4, 7, 14, 7, 11, 18, 18]
            self.column[6] = [800.0001, -120.0001, 120.0001, 800.001, -120.0001, 120.0001, 800.001, 180.001, 0.00001, 180.001]
        elif self.sequence[self.index] == 'R':
            self.column[0] = list("CHHCHHNHHCHNNHHH")
            self.column[1] = [7, 7, 7, 11, 11, 11, 14, 14, 14, 17, 17, 20, 20, 22, 23, 23]
            self.column[2] = [1.521188, 1.008823, 1.008823, 1.521188, 1.008823, 1.008823, 1.460949, 1.008823, 1.008823, 1.380001, 1.098823, 1.388889, 1.388889, 1.098823, 1.098823, 1.098823]
            self.column[3] = [4, 11, 12, 7, 14, 15, 11, 17, 18, 14, 20, 17, 22, 20, 20, 25]
            self.column[4] = [109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001]
            self.column[5] = [5, 4, 11, 4, 7, 14, 7, 11, 17, 11, 14, 21, 17, 23, 22, 20]
            self.column[6] = [800.001, -120.0001, 120.0001, 800.001, -120.0001, 120.0001, 800.001, -120.0001, 120.0001, 800.001, 180.0001, 180.0001, 180.0001, 800.001, 180.0001, 180.0001]
        elif self.sequence[self.index] == 'r':
            self.column[0] = list("CHHCHHNHHCNNHHHH")
            self.column[1] = [7, 7, 7, 11, 11, 11, 14, 14, 14, 17, 20, 20, 21, 21, 22, 22]
            self.column[2] = [1.521188, 1.008823, 1.008823, 1.521188, 1.008823, 1.008823, 1.460949, 1.008823, 1.008823, 1.380001, 1.388889, 1.388889, 1.098823, 1.098823, 1.098823, 1.098823]
            self.column[3] = [4, 11, 12, 7, 14, 15, 11, 17, 18, 14, 17, 21, 20, 23, 20, 25]
            self.column[4] = [109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001]
            self.column[5] = [5, 4, 11, 4, 7, 14, 7, 11, 17, 11, 14, 17, 17, 20, 21, 20]
            self.column[6] = [800.001, -120.0001, 120.0001, 800.001, -120.0001, 120.0001, 800.001, -120.0001, 120.0001, 800.001, 0.00001, 180.0001, 0.0001, 180.0001, 180.0001, 180.0001]
        elif self.sequence[self.index] == '4':
            self.column[0] = list("CHHCHHNHHCNNHHHHH")
            self.column[1] = [7, 7, 7, 11, 11, 11, 14, 14, 14, 17, 20, 20, 21, 21, 22, 22, 17]
            self.column[2] = [1.521188, 1.008823, 1.008823, 1.521188, 1.008823, 1.008823, 1.460949, 1.008823, 1.008823, 1.380001, 1.388889, 1.388889, 1.098823, 1.098823, 1.098823, 1.098823, 1.098823]
            self.column[3] = [4, 11, 12, 7, 14, 15, 11, 17, 18, 14, 17, 21, 20, 23, 20, 25, 14]
            self.column[4] = [109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001]
            self.column[5] = [5, 4, 11, 4, 7, 14, 7, 11, 17, 11, 14, 17, 17, 20, 21, 20, 20]
            self.column[6] = [800.001, -120.0001, 120.0001, 800.001, -120.0001, 120.0001, 800.001, -120.0001, 120.0001, 800.001, 0.00001, 180.0001, 0.0001, 180.0001, 180.0001, 180.0001, 180.0001]
        elif self.sequence[self.index] == 'S':
            self.column[0] = list("OHHH")
            self.column[1] = [7, 7, 7, 11]
            self.column[2] = [1.349827, 1.008823, 1.008823, 1.008823]
            self.column[3] = [4, 11, 12, 7]
            self.column[4] = [109.4667, 109.4667, 109.4667, 120.0001]
            self.column[5] = [5, 4, 11, 4]
            self.column[6] = [800.001, -120.0001, 120.0001, 800.001]
        elif self.sequence[self.index] == 'T':
            self.column[0] = list("OHCHHHH")
            self.column[1] = [7, 7, 7, 11, 13, 13, 13]
            self.column[2] = [1.349827, 1.008823, 1.521188, 1.008823, 1.008823, 1.008823, 1.008823]
            self.column[3] = [4, 11, 12, 7, 7, 15, 16]
            self.column[4] = [109.4667, 109.4667, 109.4667, 120.0001, 109.4667, 109.4667, 109.4667]
            self.column[5] = [5, 4, 11, 4, 12, 7, 15]
            self.column[6] = [800.001, -120.0001, 120.0001, 800.001, 180.001, -120.0001, 120.0001]
        elif self.sequence[self.index] == 'V':
            self.column[0] = list("CHCHHHHHH")
            self.column[1] = [7, 7, 7, 11, 11, 11, 13, 13, 13]
            self.column[2] = [1.521188, 1.008823, 1.521188, 1.008823, 1.008823, 1.008823, 1.008823, 1.008823, 1.008823]
            self.column[3] = [4, 11, 12, 7, 14, 15, 7, 17, 18]
            self.column[4] = [109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667, 109.4667]
            self.column[5] = [5, 4, 11, 4, 7, 14, 12, 7, 17]
            self.column[6] = [800.001, -120.001, 120.001, 180.001, -120.001, 120.001, 180.001, -120.001, 120.001]
        elif self.sequence[self.index] == 'W':
            self.column[0] = list("CHHCCHCHCHCHCNHCH")
            self.column[1] = [7, 7, 7, 11, 14, 15, 15, 17, 17, 19, 19, 21, 21, 23, 24, 24, 26]
            self.column[2] = [1.521188, 1.008823, 1.008823, 1.521188, 1.521188, 1.008823, 1.521188, 1.008823, 1.521188, 1.008823, 1.521188, 1.008823, 1.521188, 1.380001, 1.008823, 1.38001, 1.008823]
            self.column[3] = [4, 11, 12, 7, 11, 14, 16, 15, 18, 17, 20, 19, 22, 21, 23, 25, 24]
            self.column[4] = [109.4667, 109.4667, 109.4667, 127.2001, 134.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 134.0001, 125.6001, 125.2001, 120.6001]
            self.column[5] = [5, 4, 11, 4, 7, 11, 14, 16, 15, 18, 17, 20, 19, 22, 21, 23, 25]
            self.column[6] = [800.001, -120.0001, 120.0001, 800.001, 0.0001, 0.0001, 180.0001, 0.0001, 180.0001, 0.0001, 180.0001, 0.0001, 180.001, 0.0001, 0.0001, 180.0001, 0.0001]
        elif self.sequence[self.index] == 'Y':
            self.column[0] = list("CHHCHCHCOCHCHH")
            self.column[1] = [7, 7, 7, 11, 14, 14, 16, 16, 18, 18, 20, 20, 22, 19]
            self.column[2] = [1.521188, 1.008823, 1.008823, 1.521188, 1.008823, 1.521188, 1.008823, 1.521188, 1.370001, 1.521188, 1.008823, 1.521188, 1.008823, 0.960001]
            # self.column[3] = [4, 11, 12, 7, 11, 15, 14, 17, 16, 19, 18, 21, 20, 18]
            self.column[3] = [4, 11, 12, 7, 11, 15, 14, 17, 16, 19, 18, 21, 20, 7]
            self.column[4] = [109.4667, 109.4667, 109.4667, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001]
            # self.column[5] = [5, 4, 11, 4, 7, 11, 15, 14, 17, 16, 19, 18, 21, 16]
            self.column[5] = [5, 4, 11, 4, 7, 11, 15, 14, 17, 16, 19, 18, 21, 4]
            self.column[6] = [800.001, -120.0001, 120.0001, 800.001, 0.0001, 180.001, 0.00001, 180.0001, 0.0001, 180.0001, 0.0001, 180.0001, 0.00001, 800.001]
        elif self.sequence[self.index] == 'y':
            self.column[0] = list("CHHCHCHCOCHCH")
            self.column[1] = [7, 7, 7, 11, 14, 14, 16, 16, 18, 18, 20, 20, 22]
            self.column[2] = [1.521188, 1.008823, 1.008823, 1.521188, 1.008823, 1.521188, 1.008823, 1.521188, 1.370001, 1.521188, 1.008823, 1.521188, 1.008823]
            self.column[3] = [4, 11, 12, 7, 11, 15, 14, 17, 16, 19, 18, 21, 20]
            self.column[4] = [109.4667, 109.4667, 109.4667, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001, 120.0001]
            self.column[5] = [5, 4, 11, 4, 7, 11, 15, 14, 17, 16, 19, 18, 21]
            self.column[6] = [800.001, -120.0001, 120.0001, 800.001, 0.0001, 180.001, 0.00001, 180.0001, 0.0001, 180.0001, 0.0001, 180.0001, 0.00001]
    def reset(self, index):
        self.column[1:6:2] = [[(xx+7*self.index) if xx < 11 else (xx+index-10) for xx in x] for x in self.column[1:6:2]]
        it = iter(range(1, 10))
        self.column[6] = ['s'+str(1+self.index)+str(next(it)) if x > 500.0 else x for x in self.column[6]]

def wrt(sequence, mz=False, mp=False, nt="ace", ct="nme"):
    sl = "# Pm3\n\n" + ''.join(sequence) + "\n\n0 1\nN\n"
    if nt == "ace":
        sl += "C\t1\t1.345371\n"
    elif nt == "neu" or nt == "pro":
        sl += "H\t1\t1.008807\n"
    if sequence[0] == 'P':
        sl += "C\t1\t1.345371\t2\t120.00001\n"
    else:
        sl += "H\t1\t1.008807\t2\t120.00001\n"
    for i in range(len(sequence)):
        mainchain = Mainchain(i, sequence)
        mainchain.reset()
        if i == 0 and nt == "pro":
            mainchain.columns[4][0] = 109.46670
            mainchain.columns[6][0] = 120.00001
        if i == len(sequence) - 1 and ct == "neu":
            mainchain.columns[0][4] = 'O'
        if i == len(sequence) - 1 and ct == "dep":
            mainchain.columns[0][4] = 'O'
            mainchain.columns[2][4] = 1.28
            mainchain.columns[2][5] = 1.28
        for j in range(7):
            if i == len(sequence) - 1 and ct == "dep" and j == 6:
                continue
            else:
                sl += '\t'.join([str(mainchain.columns[k][j]) for k in range(6)])
                sl += '\t'
            if mz and i == (len(sequence) - 1) and j == 6:
                sl += "M0\n"
            elif mp and i < (len(sequence) - 1) and sequence[i+1] == 'P' and j == 6:
                sl += "p%d1\n" % (i+2)
            elif mp and i < (len(sequence) - 1) and sequence[i] == 'P' and j == 6:
                sl += "p%d2\n" % (i+1)
            elif mp and i == (len(sequence) - 1) and j == 6:
                # only if mz is false
                sl += "p%d2\n" % (i+1)
            else:
                sl += (str(mainchain.columns[-1][j]) + "\n")
        del mainchain
    if ct == "dep":
        index = 2 + 7 * len(sequence)
    else:
        index = 3 + 7 * len(sequence)
    for i in range(len(sequence), 0, -1):
        sidechain = Sidechain(i-1, sequence)
        sidechain.reset(index)
        for j in range(len(sidechain.column[0])):
            for k in range(6):
                if k == 2 or k == 4:
                    sl += '%.5f\t' % sidechain.column[k][j]
                else:
                    sl += (str(sidechain.column[k][j]) + "\t")
            if isinstance(sidechain.column[-1][j], float):
                sl += '%.5f\n' % sidechain.column[-1][j]
            else:
                sl += (sidechain.column[-1][j] + "\n")
        index = index + len(sidechain.column[0])
        del sidechain
    if ct == "nme":
        sl += "C\t%d\t1.34537\t%d\t120.000001\t%d\t180.000001\n" % (7*len(sequence)+1, 7*len(sequence)+3, 7*len(sequence)-2)
        sl += "H\t%d\t1.00823\t%d\t109.4667\t%d\t0.0000001\n" % (index+1, 7*len(sequence)+1, 7*len(sequence)-2)
        sl += "H\t%d\t1.00823\t%d\t109.4667\t%d\t-120.00001\n" % (index+1, index+2, 7*len(sequence)+1)
        sl += "H\t%d\t1.00823\t%d\t109.4667\t%d\t120.00001\n" % (index+1, index+3, index+2)
        index += 4
    elif ct == "nh2" or ct == "nhe":
        sl += "H\t%d\t1.00881\t%d\t120.000001\t%d\t180.000001\n" % (7*len(sequence)+1, 7*len(sequence)+3, 7*len(sequence)-2)
        index += 1
    if nt == "ace":
        if sequence[0] == 'P':
            sl += "C\t2\t1.52324\t1\t120.00001\t4\tp11\n"
        else:
            sl += "C\t2\t1.52324\t1\t120.00001\t4\t180.00001\n"
        sl += "O\t2\t1.21961\t%d\t120.00001\t1\t180.00001\n" % (index+1)
        sl += "H\t%d\t1.00823\t2\t109.4667\t1\t0.00001\n" % (index+1)
        sl += "H\t%d\t1.00823\t%d\t109.4667\t2\t-120.00001\n" % (index+1, index+3)
        sl += "H\t%d\t1.00823\t%d\t109.4667\t%d\t120.0001\n" % (index+1, index+4, index+3)
    elif nt == "pro":
        sl += "H\t1\t1.008807\t3\t109.4667\t2\t-120.00001\n"
    with open('template', 'w') as f:
        f.write(sl)

import argparse
if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument('sequence')
    parser.add_argument('-mz', action='store_true', default=False)
    parser.add_argument('-mp', action='store_true', default=False)
    parser.add_argument("-nt", default="ace")
    parser.add_argument("-ct", default="nme")
    args = parser.parse_args()
    wrt(args.sequence, mz=args.mz, mp=args.mp, nt=args.nt, ct=args.ct)


